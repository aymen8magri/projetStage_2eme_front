<div class="content-wrapper container-xxl p-0">
  <div class="content-body">
    <!-- User List Section -->
    <section class="users-list-wrapper">

      <!-- Filter Card -->
      <div class="card p-3 mb-4 shadow-lg border-primary">
        <h4>üîç Filtres</h4>
        <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-12">
            <label>Ann√©e:</label>
            <select class="form-control" [(ngModel)]="selectedAnnee" (change)="applyFilters()">
              <option value="" selected>Select Ann√©e</option>
              <option *ngFor="let y of years" [value]="y">{{ y }}</option>
            </select>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-12">
            <label>Mois:</label>
            <select class="form-control" [(ngModel)]="selectedMois" (change)="applyFilters()">
              <option value="" selected>Select Mois</option>
              <option value="01">Janvier</option>
              <option value="02">F√©vrier</option>
              <option value="03">Mars</option>
              <option value="04">Avril</option>
              <option value="05">Mai</option>
              <option value="06">Juin</option>
              <option value="07">Juillet</option>
              <option value="08">Ao√ªt</option>
              <option value="09">Septembre</option>
              <option value="10">Octobre</option>
              <option value="11">Novembre</option>
              <option value="12">D√©cembre</option>
            </select>
          </div>

          <div class="col-lg-4 col-md-4 col-sm-12">
            <label>Banque:</label>
            <select class="form-control" [(ngModel)]="selectedBanque" (change)="applyFilters()">
              <option value="" selected>Select Banque</option>
              <option *ngFor="let b of listBanques" [value]="b._id">{{ b.libelle }}</option>
            </select>
          </div>
        </div>

        <!-- Reset Filters Button -->
        <div class="d-flex justify-content-end mt-1">
          <button class="btn btn-secondary" (click)="resetFilters()">R√©initialiser les
            filtres</button>
        </div>

      </div>
      <!-- End Filter Card -->

      <!-- Table -->
      <div class="mt-3">
        <!-- En-t√™te du bilan -->

        <div class="card mb-4 shadow-sm border-primary">
          <!-- En-t√™te du bilan -->
          <div class="card-header bg-primary text-white">
            <h3>Bilan du Mois - {{ selectedMois }}/{{ selectedAnnee }}</h3>
            <div class="d-flex">
              <h3>Banque : {{ tabDeBord?.idBanque?.libelle }}</h3>
            </div>
          </div>

          <!--affichage des resultats du bilan-->
          <div class="card-body mt-1" *ngIf="isTabDeBordNotEmpty(); else noResults">
            <!-- Partie sup√©rieure avec encaissements, d√©caissements et escompte -->
            <div class="row">
              <div class="col-md-4">
                <p><strong>Encaissement :</strong> {{ tabDeBord.encaissement | number:'1.2-2' }}</p>
                <p><strong>D√©caissement :</strong> {{ tabDeBord.decaissement | number:'1.2-2' }}</p>
                <p><strong>Escompte :</strong> {{ tabDeBord.escompte | number:'1.2-2' }}</p>
              </div>
              <div class="col-md-4">
                <p><strong>Encaissement Suppl√©mentaire :</strong> {{ tabDeBord.encaissementSupp | number:'1.2-2' }}</p>
                <p><strong>D√©caissement Suppl√©mentaire :</strong> {{ tabDeBord.decaissementSupp | number:'1.2-2' }}</p>
                <p><strong>Montant Suppl√©mentaire :</strong> {{ tabDeBord.montantSupp | number:'1.2-2' }}</p>
              </div>
              <div class="col-md-4">
                <p><strong>Tr√©sorerie du Mois :</strong> {{ tabDeBord.tresorerie_de_mois | number:'1.2-2' }}</p>
              </div>
            </div>

            <hr>

            <!-- Partie sur les impay√©s -->
            <div class="row">
              <div class="col-md-6">
                <p><strong>Impay√©s Pr√©vus Clients :</strong> {{ tabDeBord.impayesPrevusClients | number:'1.2-2' }}</p>
                <p><strong>Impay√©s Confirm√©s Clients :</strong> {{ tabDeBord.impayesConfirmesClients | number:'1.2-2' }}
                </p>
              </div>
              <div class="col-md-6">
                <p><strong>Impay√©s Pr√©vus Fournisseurs :</strong> {{ tabDeBord.impayesPrevusFournisseurs |
                  number:'1.2-2' }}</p>
                <p><strong>Impay√©s Confirm√©s Fournisseurs :</strong> {{ tabDeBord.impayesConfirmesFournisseurs |
                  number:'1.2-2' }}</p>
              </div>
            </div>

            <div class="row mt-3">
              <div class="col-md-6">
                <p><strong>Impay√©s Pr√©vus Escompte :</strong> {{ tabDeBord.impayesPrevusEscompte | number:'1.2-2' }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Impay√©s Confirm√©s Escompte :</strong> {{ tabDeBord.impayesConfirmesEscompte | number:'1.2-2'
                  }}</p>
              </div>
            </div>

            <hr>

            <!-- Partie inf√©rieure avec soldes -->
            <div class="row">
              <div class="col-md-6">
                <p><strong>Solde Pr√©vu :</strong> {{ tabDeBord.soldePrevus | number:'1.2-2' }}</p>
              </div>
              <div class="col-md-6">
                <p><strong>Solde Final :</strong> {{ tabDeBord.soldeFinal | number:'1.2-2' }}</p>
              </div>
            </div>

            <!-- Observations -->
            <div class="mt-3">
              <strong>Observations :</strong>
              <div [innerHTML]="tabDeBord?.observation"></div>
            </div>

            
          </div>

          <hr>

            <!-- Aper√ßu des barChart  -->
            <div class="col-12" *ngIf="tabDeBord">
              <div class="card">
                <div class="card-header">
                  <div>
                    <h4 class="card-title">Aper√ßu des statistiques</h4>
                    <span class="card-subtitle text-muted">Encaissement && D√©caissement</span>
                  </div>
                </div>
                <div class="card-body">
                  <canvas id="barChart"></canvas>

                </div>
              </div>
            </div>

          <!--No result found section-->
          <ng-template #noResults>
              <div  class="text-center">
                <ngb-alert type="warning" class="mb-2 mt-2 w-50 mx-auto p-2 ">
                  <div class="alert-heading">Aucun r√©sultat trouv√©</div>
                  <div class="alert-body mt-1 ">
                    Veuillez modifier les filtres pour afficher R√©sultat.
                  </div>
                </ngb-alert>
              </div>
          </ng-template>

        </div>
      </div>

    </section>
  </div>
</div>